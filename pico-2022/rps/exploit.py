from pwn import *

def get_turns():
    # generate our random turns
    turns = process('./a.out')
    t1 = turns.recvline().strip().decode()
    t2 = turns.recvline().strip().decode()
    t3 = turns.recvline().strip().decode()
    t4 = turns.recvline().strip().decode()
    t5 = turns.recvline().strip().decode()
    return [t1, t2, t3, t4, t5]

WIN_MAP = {"0": "paper",  "1": "scissors", "2": "rock"}

conn = remote('saturn.picoctf.net', 53296)
conn.recv()
conn.sendline('1') # play game
conn.recv() # clear make selection text

for turn in get_turns():
    conn.sendline(WIN_MAP[turn])
    conn.sendline('1') # play again...

# may have to run a few times but it works
conn.interactive()
